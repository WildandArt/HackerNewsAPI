<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Hacker News API: Welcome to the Mini Hacker News project</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Hacker News API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Welcome to the Mini Hacker News project </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Mini Hacker News Project is an implementation of a content aggregation platform similar to Hacker News. This project provides a RESTful API for managing posts, allowing users to submit, view, and interact with various news articles. The core feature of the application is its caching system, which stores posts in a cache for efficient retrieval while ensuring that cached data remains fresh and relevant. By implementing a caching strategy, the project optimizes performance and reduces the load on the database, making it capable of handling high traffic scenarios typical of popular news aggregation sites.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Table of Contents</h1>
<ol type="1">
<li><a href="#requirements">Requirements</a></li>
<li><a href="#main-entities">Main Entities</a></li>
<li><a href="#features">Features</a></li>
<li><a href="#uml-diagram">UML Diagram</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#installation">Installation</a><ul>
<li><a href="#application-properties-configuration">Application Properties Configuration</a></li>
<li><a href="#database-connection-settings">Database connection settings</a></li>
<li><a href="#user-configuration-settings">User Configuration Settings</a></li>
<li><a href="#docker-usage">Docker Usage</a></li>
</ul>
</li>
<li><a href="#allowed-crud-operations">Allowed CRUD Operations</a><ul>
<li><a href="#endpoints">Endpoints</a></li>
<li><a href="#postman-collection">Postman Collection</a></li>
<li><a href="#error-handling">Error Handling</a></li>
</ul>
</li>
<li><a href="#cache-strategy">Cache Strategy</a></li>
<li><a href="#support-and-contributions">Support and Contributions</a></li>
<li><a href="#license">License</a></li>
</ol>
<h1><a class="anchor" id="autotoc_md6"></a>
Requirements</h1>
<p>Before running this project, you need to install the Java Development Kit (JDK). Follow these steps:</p>
<ol type="1">
<li>Download the latest Java JDK from the <a href="https://www.oracle.com/java/technologies/javase-jdk11-downloads.html">Oracle website</a>.</li>
<li>Install the JDK on your machine. If you need help, follow the installation instructions specific to your operating system.</li>
<li>Verify the installation by opening a terminal and running <code>java -version</code>. This should display the version of the Java JDK.</li>
</ol>
<p>Additionally, ensure that you have Maven installed to manage project dependencies. Install Maven by following the instructions on the <a href="https://maven.apache.org/install.html">Apache Maven Project website</a>.</p>
<h1><a class="anchor" id="autotoc_md7"></a>
Main Entities</h1>
<h2><a class="anchor" id="autotoc_md8"></a>
1. &lt;strong&gt;NewsPostModelImpl&lt;/strong&gt;</h2>
<ul>
<li><b>Description</b>: Represents the main entity for a news post in the application.</li>
<li><b>Key Fields</b>:<ul>
<li><code>postId</code>: Unique identifier for the post.</li>
<li><code>url</code>: The URL of the news post.</li>
<li><code>title</code>: The title of the post.</li>
<li><code>currentVotes</code>: Number of votes the post has received.</li>
<li><code>createdAt</code>: Timestamp when the post was created.</li>
<li><code>score</code>: Score of the post, typically derived from its popularity.</li>
<li><code>timeElapsed</code>: Time elapsed since the post was created.</li>
<li><code>postedBy</code>: The author of the post.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md9"></a>
2. &lt;strong&gt;CacheEntityImpl&lt;/strong&gt;</h2>
<ul>
<li><b>Description</b>: Represents a custom implementation of a caching mechanism to store and retrieve <code>NewsPostModelImpl</code> objects.</li>
<li><b>Key Features</b>:<ul>
<li>Caches posts to improve retrieval speed and reduce database queries.</li>
<li>Implements size-limiting and stale data invalidation logic.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md10"></a>
3. &lt;strong&gt;CacheEntityServiceImpl&lt;/strong&gt;</h2>
<ul>
<li><b>Description</b>: Service that interacts with <code>CacheEntityImpl</code> to provide caching functionalities.</li>
<li><b>Key Operations</b>:<ul>
<li><code>getPostFromCacheById(Long postId)</code>: Retrieves a single post from the cache by its ID.</li>
<li><code>getAllPostsFromCache()</code>: Retrieves all cached posts, with a check for stale data.</li>
<li><code>putPostInCache(NewsPostModelImpl post)</code>: Adds a single post to the cache.</li>
<li><code>putAllPostsInCache(List&lt;NewsPostModelImpl&gt; posts)</code>: Adds a list of posts to the cache.</li>
<li><code>evictPost(Long postId)</code>: Removes a specific post from the cache.</li>
<li><code>clearCache()</code>: Clears all entries in the cache.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md11"></a>
4. &lt;strong&gt;PostRepository&lt;/strong&gt;</h2>
<ul>
<li><b>Description</b>: Repository interface for managing <code>NewsPostModelImpl</code> entities in the database.</li>
<li><b>Key Features</b>:<ul>
<li>Provides basic CRUD operations for <code>NewsPostModelImpl</code>.</li>
<li>Extends Spring Data JPA, making it easy to interact with the database.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md12"></a>
5. &lt;strong&gt;NewsPostsResponseDTO&lt;/strong&gt;</h2>
<ul>
<li><b>Description</b>: Data Transfer Object interface used for transferring data related to news posts between the API and the client.</li>
<li><b>Key Fields</b>:<ul>
<li><code>postId</code>, <code>url</code>, <code>title</code>, <code>currentVotes</code>, <code>createdAt</code>, <code>score</code>, <code>postedBy</code>, etc.</li>
<li>These fields correspond closely to those in <code>NewsPostModelImpl</code>.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md13"></a>
6. &lt;strong&gt;HackerNewsAPIApplication&lt;/strong&gt;</h2>
<ul>
<li><b>Description</b>: The main entry point for the Spring Boot application.</li>
<li><b>Key Features</b>:<ul>
<li>Initializes and configures the application.</li>
<li>Scans and sets up Spring Data JPA repositories and other Spring components.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md14"></a>
Supporting Components</h1>
<h2><a class="anchor" id="autotoc_md15"></a>
Database (PostgreSQL)</h2>
<ul>
<li><b>Description</b>: Manages the persistence of <code>NewsPostModelImpl</code> entities.</li>
<li><b>Configuration</b>: Integrated with Docker Compose for seamless setup and management in development and production environments.</li>
</ul>
<h2><a class="anchor" id="autotoc_md16"></a>
Docker &amp; Docker Compose</h2>
<ul>
<li><b>Dockerfile</b>: Defines a multi-stage build for creating a lightweight Docker image of the application.</li>
<li><b>docker-compose.yml</b>: Configures the services, including the database and the application itself, for easy deployment.</li>
</ul>
<h1><a class="anchor" id="autotoc_md17"></a>
Project Structure</h1>
<ul>
<li>**<code>src/main/java/com/username/HackerNewsAPI/</code>**: Contains the main source code, including models, services, and repositories.</li>
<li>**<code>src/test/java/com/username/HackerNewsAPI/</code>**: Contains the test classes for unit and integration testing.</li>
</ul>
<h1><a class="anchor" id="autotoc_md18"></a>
Features</h1>
<ol type="1">
<li><b>Real-time Content Aggregation</b><ul>
<li>Allows users to submit and view news posts in real-time. The application aggregates and ranks posts based on their scores, which are influenced by user votes and time elapsed.</li>
</ul>
</li>
<li><b>Custom Caching Mechanism</b><ul>
<li>Implements a high-performance caching system that stores the top posts in memory, reducing the load on the database and improving response times. The cache automatically evicts the least relevant posts when it reaches capacity and updates when posts are created, updated, or voted on.</li>
<li><b>Thread Safety</b>: The caching mechanism is designed to be thread-safe, ensuring that multiple threads can access and modify the cache simultaneously without causing data inconsistencies. This is achieved through synchronized methods and concurrent data structures like <code>ConcurrentHashMap</code>.</li>
</ul>
</li>
<li><b>Dynamic Post Ranking</b><ul>
<li>Posts are ranked dynamically based on a custom scoring algorithm that takes into account both the number of votes and the time elapsed since posting. This ensures that the most relevant and popular posts are always at the top.</li>
</ul>
</li>
<li><b>Upvote and Downvote Functionality</b><ul>
<li>Users can upvote or downvote posts, which directly influences the post’s score and ranking. This feature is crucial for maintaining an accurate and community-driven ranking system.</li>
</ul>
</li>
<li><b>Pagination and Query Optimization</b><ul>
<li>Supports efficient pagination for large datasets, allowing users to navigate through posts with minimal performance impact. The application includes optimized queries to ensure quick retrieval of data.</li>
</ul>
</li>
<li><b>Flexible Configuration</b><ul>
<li>Provides configurable settings for cache size, pagination limits, update intervals, and logging levels. This allows administrators to tailor the application’s performance and behavior to their specific needs.</li>
</ul>
</li>
<li><b>Robust Error Handling</b><ul>
<li>Implements comprehensive error handling throughout the application, ensuring that users receive informative and user-friendly messages in case of issues, while also logging detailed errors for developers.</li>
</ul>
</li>
<li><b>Responsive API Endpoints</b><ul>
<li>Exposes a RESTful API that allows clients to interact with the application, including creating, retrieving, updating, voting on, and deleting posts. The API is designed to be efficient and easy to integrate with other systems.</li>
</ul>
</li>
<li><b>Post Scheduling and Maintenance</b><ul>
<li>Includes scheduled tasks that automatically update post scores and other fields at regular intervals, ensuring that the data remains fresh and relevant without manual intervention.</li>
</ul>
</li>
<li><b>Comprehensive Testing</b><ul>
<li>Includes unit tests, integration tests, and Postman collections to ensure the application is reliable, with all key functionalities thoroughly tested.</li>
</ul>
</li>
</ol>
<h1><a class="anchor" id="autotoc_md19"></a>
UML Diagram</h1>
<p><img src="img/diagram.png" alt="" class="inline"/> </p>
<h1><a class="anchor" id="autotoc_md20"></a>
Prerequisites</h1>
<p>Before you can run this project, ensure that you have the following software installed:</p>
<ol type="1">
<li><b>Java Development Kit (JDK)</b>:<ul>
<li>Version: <code>17</code> or higher.</li>
<li>You can download it from <a href="https://adoptopenjdk.net/">AdoptOpenJDK</a> or use a package manager like <code>sdkman</code> to install it.</li>
</ul>
</li>
<li><b>Maven</b>:<ul>
<li>Version: <code>3.6.0</code> or higher.</li>
<li>Maven is used to build and manage the dependencies of the project. Download it from the <a href="https://maven.apache.org/download.cgi">official website</a> or install it via a package manager like <code>brew</code> on macOS, <code>apt</code> on Ubuntu, or <code>choco</code> on Windows.</li>
</ul>
</li>
<li><b>Docker</b>:<ul>
<li>Docker is required to containerize the application and its dependencies.</li>
<li>Make sure Docker is installed and running on your machine. You can download Docker Desktop from <a href="https://www.docker.com/products/docker-desktop">here</a>.</li>
</ul>
</li>
<li><b>Docker Compose</b>:<ul>
<li>Version: <code>1.27.0</code> or higher.</li>
<li>Docker Compose is used to manage multi-container Docker applications. It is usually included with Docker Desktop, but you can install it separately if needed.</li>
</ul>
</li>
<li><b>PostgreSQL</b>:<ul>
<li>Version: <code>15.3</code> or compatible.</li>
<li>This project uses PostgreSQL as the database. You can either run PostgreSQL via Docker or install it locally on your machine.</li>
<li><b>Docker Approach</b>: You can include PostgreSQL in your Docker setup. Ensure you have the correct environment variables set for <code>POSTGRES_DB</code>, <code>POSTGRES_USER</code>, and <code>POSTGRES_PASSWORD</code>.</li>
<li><b>Local Installation</b>: If you prefer to install PostgreSQL locally, download it from the <a href="https://www.postgresql.org/download/">official PostgreSQL website</a>. After installation, ensure the PostgreSQL service is running, and you've created the necessary database and user. For help with installation and setup, refer to the <a href="https://www.postgresql.org/docs/">PostgreSQL Documentation</a>.</li>
<li><b>Environment Variables</b>: Ensure you set up the following environment variables:<ul>
<li><code>POSTGRES_DB</code>: Name of your database</li>
<li><code>POSTGRES_USER</code>: Your PostgreSQL username</li>
<li><code>POSTGRES_PASSWORD</code>: Your PostgreSQL password </li>
</ul>
</li>
</ul>
</li>
</ol>
<h2><a class="anchor" id="autotoc_md21"></a>
Basic PostgreSQL Commands</h2>
<ul>
<li><b>Connecting to PostgreSQL</b>: ```bash psql -U username -d database ``` If PostgreSQL is installed locally, you can connect to the default database: ```bash psql -U postgres ```</li>
<li><b>Checking PostgreSQL Status</b>:<ul>
<li><b>On Ubuntu/Debian</b>: ```bash sudo systemctl status postgresql ```</li>
<li><b>On macOS with Homebrew</b>: ```bash brew services list | grep postgresql ```</li>
<li><b>On Windows</b>: ```powershell Get-Service -Name postgresql* ```</li>
</ul>
</li>
<li><b>Starting PostgreSQL</b>:<ul>
<li><b>On Ubuntu/Debian</b>: ```bash sudo systemctl start postgresql ```</li>
<li><b>On macOS with Homebrew</b>: ```bash brew services start postgresql ```</li>
<li><b>On Windows</b>: ```powershell Start-Service -Name postgresql* ```</li>
</ul>
</li>
<li><b>Stopping PostgreSQL</b>:<ul>
<li><b>On Ubuntu/Debian</b>: ```bash sudo systemctl stop postgresql ```</li>
<li><b>On macOS with Homebrew</b>: ```bash brew services stop postgresql ```</li>
<li><b>On Windows</b>: ```powershell Stop-Service -Name postgresql* ```</li>
</ul>
</li>
<li><b>Restarting PostgreSQL</b>:<ul>
<li><b>On Ubuntu/Debian</b>: ```bash sudo systemctl restart postgresql ```</li>
<li><b>On macOS with Homebrew</b>: ```bash brew services restart postgresql ```</li>
<li><b>On Windows</b>: ```powershell Restart-Service -Name postgresql* ```</li>
</ul>
</li>
</ul>
<p>For more help with PostgreSQL installation and management, refer to the <a href="https://www.postgresql.org/docs/">official PostgreSQL documentation</a>.</p>
<ol type="1">
<li><b>Git</b>:<ul>
<li>Version: <code>2.0</code> or higher.</li>
<li>Git is used for version control. Make sure you have Git installed to clone the repository.</li>
</ul>
</li>
</ol>
<h2><a class="anchor" id="autotoc_md22"></a>
Environment Variables</h2>
<p>Ensure the following environment variables are set up:</p>
<ul>
<li><code>POSTGRES_DB</code>: Name of the PostgreSQL database.</li>
<li><code>POSTGRES_USER</code>: PostgreSQL username.</li>
<li><code>POSTGRES_PASSWORD</code>: PostgreSQL password.</li>
</ul>
<h2><a class="anchor" id="autotoc_md23"></a>
Optional Tools</h2>
<ul>
<li><b>IDE</b>:<ul>
<li>An Integrated Development Environment (IDE) like IntelliJ IDEA, Eclipse, or VS Code is recommended for working with the project.</li>
</ul>
</li>
<li><b>cURL or Postman</b>:<ul>
<li>These tools can be useful for testing API endpoints once the application is up and running.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md24"></a>
Installation</h1>
<ol type="1">
<li><b>Clone the repository</b></li>
</ol>
<div class="fragment"><div class="line">git clone https://github.com/WildandArt/HackerNewsAPI.git</div>
<div class="line">cd mini-hacker-news</div>
</div><!-- fragment --><ol type="1">
<li><p class="startli"><b>Install dependencies</b></p>
<p class="startli">Using Maven, you can install all required dependencies for the project:</p>
</li>
</ol>
<div class="fragment"><div class="line">mvn install</div>
</div><!-- fragment --><ol type="1">
<li><p class="startli"><b>Run the application</b></p>
<p class="startli">Once the dependencies are installed, you can run the application using:</p>
</li>
</ol>
<div class="fragment"><div class="line">mvn spring-boot:run</div>
</div><!-- fragment --><p>This will start the application on <a href="http://localhost:8080">http://localhost:8080</a>.</p>
<h1><a class="anchor" id="autotoc_md25"></a>
Application Properties Configuration</h1>
<p>The following properties are configured to manage the database connection, Hibernate settings, and data source details for the application. These configurations ensure that the application connects to the correct database, uses the appropriate credentials, and utilizes Hibernate for ORM (Object-Relational Mapping) with PostgreSQL.</p>
<h3><a class="anchor" id="autotoc_md26"></a>
Database Connection Properties</h3>
<ul>
<li><code>spring.datasource.url</code>: Specifies the JDBC URL for connecting to the PostgreSQL database. This should be adjusted based on whether the application is running locally or within Docker. For local development, use <code>jdbc:postgresql://localhost:5432/mytestdatabase</code>. When using Docker, adjust it accordingly.</li>
<li><code>spring.datasource.username</code>: The username used for authenticating the connection to the PostgreSQL database.</li>
<li><code>spring.datasource.password</code>: The password associated with the username for database authentication.</li>
<li><code>spring.datasource.driver-class-name</code>: Specifies the driver class name for PostgreSQL, which is <code>org.postgresql.Driver</code>.</li>
</ul>
<h3><a class="anchor" id="autotoc_md27"></a>
Hibernate Settings</h3>
<ul>
<li><code>spring.jpa.database-platform</code>: Defines the SQL dialect for Hibernate, set to <code>org.hibernate.dialect.PostgreSQLDialect</code> to match PostgreSQL.</li>
<li><code>spring.jpa.hibernate.ddl-auto</code>: Configures the Hibernate DDL (Data Definition Language) auto-generation behavior. Set to <code>update</code> to automatically update the database schema as needed.</li>
<li><code>spring.jpa.show-sql</code>: If set to <code>true</code>, Hibernate will log the generated SQL statements to the console, which is useful for debugging and development.</li>
</ul>
<h3><a class="anchor" id="autotoc_md28"></a>
Example Properties File</h3>
<div class="fragment"><div class="line"># Database connection properties for local development</div>
<div class="line">spring.datasource.url=jdbc:postgresql://localhost:5432/mytestdatabase</div>
<div class="line">spring.datasource.username=mytestuser</div>
<div class="line">spring.datasource.password=mytestpassword</div>
<div class="line">spring.datasource.driver-class-name=org.postgresql.Driver</div>
<div class="line"> </div>
<div class="line"># Hibernate settings</div>
<div class="line">spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect</div>
<div class="line">spring.jpa.hibernate.ddl-auto=update</div>
<div class="line">spring.jpa.show-sql=true</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md29"></a>
Database connection settings</h1>
<p>Configure your application properties to connect to the PostgreSQL database inside the Docker container. This file is typically located at src/main/resources/application.properties. Using Docker Version of properties file: </p><div class="fragment"><div class="line">spring.datasource.url=jdbc:postgresql://db:5432/mydatabase</div>
</div><!-- fragment --><p>If you need to run the application locally without Docker, use the following settings. </p><div class="fragment"><div class="line">spring.datasource.url=jdbc:postgresql://localhost:5432/mytestdatabase</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md30"></a>
User Configuration Settings</h1>
<p>In addition to the database connection properties, you can also configure various aspects of the application, such as cache size, pagination limits, logging levels, and update intervals. Below are the key properties you can adjust:</p>
<h3><a class="anchor" id="autotoc_md31"></a>
Cache Size and Pagination Limit</h3>
<ul>
<li><p class="startli"><code>cache.size</code>: This property controls the maximum number of posts that can be stored in the cache. Adjusting this value allows you to optimize the cache according to your application's needs. If not set, the default value is 100</p>
<p class="startli">Example: </p><div class="fragment"><div class="line">cache.size=100</div>
</div><!-- fragment --> </li>
</ul>
<h3><a class="anchor" id="autotoc_md32"></a>
Database Update Interval</h3>
<ul>
<li><code>db.update.interval</code>: This property sets the interval at which certain fields in the database (e.g., time elapsed) are updated. The value is in milliseconds.</li>
</ul>
<div class="fragment"><div class="line">db.update.interval=600000  # 10 minutes</div>
<div class="line"># 3600000  # 1 hour in milliseconds</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md33"></a>
Log File Path</h3>
<ul>
<li><code>logging.file.name</code>: Specifies the path and filename for the application's log file. This allows you to direct all logs to a specific file for easy monitoring and debugging. <div class="fragment"><div class="line">logging.file.name=logs/myapp.log</div>
</div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="autotoc_md34"></a>
Docker Usage</h1>
<div class="fragment"><div class="line"><span class="preprocessor"># First stage: Build the application with Maven</span></div>
<div class="line">FROM eclipse-temurin:17-jdk-ubi9-minimal as build</div>
<div class="line">WORKDIR /app</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Install Maven</span></div>
<div class="line">RUN microdnf install -y maven</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Copy the pom.xml file and download dependencies</span></div>
<div class="line">COPY pom.xml .</div>
<div class="line">RUN mvn dependency:go-offline</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Copy the source code and build the application</span></div>
<div class="line">COPY src ./src</div>
<div class="line">RUN mvn <span class="keyword">package </span>-DskipTests</div>
<div class="line"> </div>
<div class="line"># Second stage: Use a lightweight JRE to run the application</div>
<div class="line">FROM eclipse-temurin:17-jre-ubi9-minimal</div>
<div class="line">WORKDIR /app</div>
<div class="line">COPY --from=build /app/target/HackerNewsAPI-0.0.1-SNAPSHOT.jar app.jar</div>
<div class="line">ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;app.jar&quot;]</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md35"></a>
Using Docker Compose to Run the Application</h2>
<h3><a class="anchor" id="autotoc_md36"></a>
1. &lt;strong&gt;Pull the Docker Image&lt;/strong&gt;</h3>
<p>First, you need to pull the Docker image from Docker Hub. </p><div class="fragment"><div class="line">docker pull artozersky/hackernewsapi_app:latest</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md37"></a>
2. &lt;strong&gt;Navigate to the Project Directory&lt;/strong&gt;</h3>
<p>Make sure you're in the directory where your docker-compose.yml file is located. Then, start the application in detached mode: </p><div class="fragment"><div class="line">docker-compose up -d</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md38"></a>
4. &lt;strong&gt;Verify Running Containers&lt;/strong&gt;</h3>
<p>To verify that your containers are running, use the following command: </p><div class="fragment"><div class="line">docker-compose ps</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md39"></a>
5. &lt;strong&gt;Access the Application&lt;/strong&gt;</h3>
<p>The application should now be accessible via your web browser at: </p><div class="fragment"><div class="line">http://localhost:8181/api/posts</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md40"></a>
6. &lt;strong&gt;Stop the Running Services&lt;/strong&gt;</h3>
<p>To stop all running services, use the following command: </p><div class="fragment"><div class="line">docker-compose down</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md41"></a>
7. &lt;strong&gt;Restart the Application&lt;/strong&gt;</h3>
<p>To restart the application after stopping it, simply use: </p><div class="fragment"><div class="line">docker-compose up -d</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md42"></a>
8. &lt;strong&gt;Remove Docker Images&lt;/strong&gt;</h3>
<p>If you need to remove the images used by Docker Compose, you can do so after stopping the services: </p><div class="fragment"><div class="line">docker-compose down --rmi all</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md43"></a>
Allowed CRUD Operations</h2>
<ul>
<li>Create new posts</li>
<li>Get a Post by Id</li>
<li>Get top posts</li>
<li>Get all posts</li>
<li>Update an existing post</li>
<li>Upvote/Downvote a post</li>
<li>Delete a post</li>
</ul>
<h2><a class="anchor" id="autotoc_md44"></a>
Endpoints</h2>
<h3><a class="anchor" id="autotoc_md45"></a>
Create a Post</h3>
<p>Method: POST URL: <a href="http://localhost:8080/api/posts">http://localhost:8080/api/posts</a></p>
<p>Headers:</p>
<p>Content-Type: application/json Request Body: JSON </p><div class="fragment"><div class="line">{</div>
<div class="line">&quot;userId&quot;: 1,</div>
<div class="line">&quot;author&quot;: &quot;John Doe&quot;,</div>
<div class="line">&quot;url&quot;: &quot;http://example.com/post&quot;,</div>
<div class="line">&quot;title&quot;: &quot;My First Post&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Response: The response will be the newly created DTO Response post object in JSON format.</p>
<h3><a class="anchor" id="autotoc_md46"></a>
Get a Post by Id</h3>
<p>Method: GET</p>
<p>URL: <code><a href="http://localhost:8080/api/posts/{id}">http://localhost:8080/api/posts/{id}</a> (replace {id} with the actual post ID)</code></p>
<p>Response: The response will be the DTO post object with the specified ID in JSON format.</p>
<h3><a class="anchor" id="autotoc_md47"></a>
Get Top Posts</h3>
<p>Method: GET</p>
<p>URL: <code><a href="http://localhost:8080/api/top_posts">http://localhost:8080/api/top_posts</a></code></p>
<p>Response: The response will be an array of the top posts in JSON format.</p>
<h3><a class="anchor" id="autotoc_md48"></a>
Get All Posts</h3>
<p>Method: GET URL: </p><div class="fragment"><div class="line"> {http://localhost:8080/api/posts```}</div>
<div class="line">Response: The response will be an array of all posts in JSON format.</div>
<div class="line"> </div>
<div class="line">### Update a Post</div>
<div class="line"> </div>
<div class="line">Method: PUT</div>
<div class="line"> </div>
<div class="line">URL: ```http://localhost:8080/api/posts/{id} </div>
</div><!-- fragment --><p>(replace {id} with the actual post ID) Headers:</p>
<p>Content-Type: application/json</p>
<p>Request Body: JSON</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;url&quot;: &quot;www.example.com&quot;,</div>
<div class="line">  &quot;title&quot;: &quot;Updated title&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Response: The response will be the updated post object in JSON format.</p>
<h3><a class="anchor" id="autotoc_md49"></a>
Upvote a Post</h3>
<p>Method: PATCH</p>
<p>URL: <code><a href="http://localhost:8080/api/posts/{id}/upvote">http://localhost:8080/api/posts/{id}/upvote</a></code></p>
<p>(replace {id} with the actual post ID) Response: The response will be the updated post object with the incremented upvote count in JSON format.</p>
<h3><a class="anchor" id="autotoc_md50"></a>
Downvote a Post</h3>
<p>Method: PATCH</p>
<p>URL: <code><a href="http://localhost:8080/api/posts/{id}/downvote">http://localhost:8080/api/posts/{id}/downvote</a></code></p>
<p>(replace {id} with the actual post ID) Response: The response will be the updated post object with the decremented downvote count in JSON format.</p>
<h3><a class="anchor" id="autotoc_md51"></a>
Delete a Post</h3>
<p>Method: DELETE</p>
<p>URL: <code><a href="http://localhost:8080/api/posts/{id}">http://localhost:8080/api/posts/{id}</a></code></p>
<p>(replace {id} with the actual post ID)</p>
<p>Response: A successful deletion typically returns a 204 No Content status code. </p>
<h1><a class="anchor" id="autotoc_md52"></a>
Postman collection</h1>
<ul>
<li>How to Use a Postman Collection JSON File</li>
</ul>
<h2><a class="anchor" id="autotoc_md53"></a>
1. Download the Collection JSON File</h2>
<ul>
<li>First, ensure you have the Postman collection JSON file saved to your local machine. You can access the Postman collection file <a href="Postman/HackerNewsAPI.postman_collection.json">here</a>. This file contains all the endpoints, requests, and configurations defined in the collection.</li>
</ul>
<h2><a class="anchor" id="autotoc_md54"></a>
2. Importing the Collection into Postman</h2>
<ol type="1">
<li><b>Open Postman.</b></li>
<li>On the main interface, look for the <b>“Import”</b> button. This is usually located on the top left side of the app.</li>
<li>Click on <b>“Import.”</b></li>
<li>In the import dialog that appears, choose the <b>“Upload Files”</b> tab.</li>
<li>Click <b>“Choose Files”</b> or drag the JSON file directly into the import area.</li>
<li>Navigate to <code>HackerNewsAPI/Postman/HackerNewsAPI.postman_collection.json</code> and select it.</li>
<li>Once the file is selected, click <b>“Import”</b> to load the collection into Postman.</li>
</ol>
<h2><a class="anchor" id="autotoc_md55"></a>
3. Using the Imported Collection</h2>
<ul>
<li>After importing, the collection will appear in your **"Collections"** tab on the left sidebar.</li>
<li>Expand the collection to view all the requests, folders, and other configurations within it.</li>
<li>Click on any request to view its details, including the method, URL, headers, and body content.</li>
<li>You can now execute any of the requests by selecting them and clicking the <b>“Send”</b> button.</li>
</ul>
<h2><a class="anchor" id="autotoc_md56"></a>
4. Editing and Customizing the Collection</h2>
<ul>
<li>You can modify any request within the collection to suit your needs. This includes changing endpoints, parameters, headers, and body content.</li>
<li>If you need to add new requests, you can do so within the same collection by right-clicking the collection name and selecting **"Add Request."**</li>
</ul>
<h2><a class="anchor" id="autotoc_md57"></a>
5. Running Tests and Pre-Scripts</h2>
<ul>
<li>If the collection includes tests or pre-request scripts, these will run automatically when you send the requests.</li>
<li>To view or edit these scripts, click on the <b>“Tests”</b> or <b>“Pre-request Script”</b> tab within the request.</li>
</ul>
<h2><a class="anchor" id="autotoc_md58"></a>
6. Saving and Exporting Changes</h2>
<ul>
<li>After making changes to the collection, you can save your work by clicking the save button.</li>
<li>If you need to share your modified collection with others, you can export it by right-clicking the collection name, selecting <b>“Export,”</b> and choosing the format (usually JSON).</li>
</ul>
<h1><a class="anchor" id="autotoc_md59"></a>
Error Handling</h1>
<h2><a class="anchor" id="autotoc_md60"></a>
Global Exception Handler in Mini Hacker News</h2>
<p>The <b>Global Exception Handler</b> in the Mini Hacker News project is a centralized mechanism that manages and handles exceptions occurring within the application. This component ensures that all exceptions are captured and processed uniformly, providing clear and structured feedback to API consumers.</p>
<h3><a class="anchor" id="autotoc_md61"></a>
Key Features</h3>
<ul>
<li><b>Centralized Error Handling</b>: All exceptions are managed in a single location, reducing redundancy and promoting consistent error handling throughout the application.</li>
<li><b>Custom Exception Responses</b>: The handler catches specific exceptions like <code>CustomNotFoundException</code> or <code>DataIntegrityViolationException</code> and returns meaningful error messages and appropriate HTTP status codes.</li>
<li><b>User-Friendly Error Messages</b>: Instead of exposing internal server errors or stack traces, the Global Exception Handler returns user-friendly error messages that help clients understand what went wrong without revealing sensitive details.</li>
</ul>
<h3><a class="anchor" id="autotoc_md62"></a>
Exception Handling Methods</h3>
<p>The <code>GlobalExceptionHandler</code> class provides specific methods to handle various types of exceptions:</p>
<ol type="1">
<li><b>General Exception Handling</b>:<ul>
<li><b>Method</b>: <code>handleGeneralException</code></li>
<li><b>Handles</b>: All unhandled exceptions (<code>Exception.class</code>)</li>
<li><b>Response</b>: ```json { "message": "An unexpected error occurred: {exception message}" } ``<code></code></li>
<li><code>**HTTP Status**:</code>500 Internal Server Error`</li>
</ul>
</li>
<li><b>Database Access Exceptions</b>:<ul>
<li><b>Method</b>: <code>handleDataAccessException</code></li>
<li><b>Handles</b>: Exceptions related to database operations (<code>DataAccessException.class</code>)</li>
<li><b>Response</b>: ```json { "message": "Database error: {exception message}" } ``<code></code></li>
<li><code>**HTTP Status**:</code>500 Internal Server Error`</li>
</ul>
</li>
<li><b>Validation Errors</b>:<ul>
<li><b>Method</b>: <code>handleMethodArgumentNotValid</code></li>
<li><b>Handles</b>: Validation failures for method arguments annotated with <code>@Valid</code> (<code>MethodArgumentNotValidException.class</code>)</li>
<li><b>Response</b>: ```json { "{field}": "{error message}" } ``<code></code></li>
<li><code>**HTTP Status**:</code>400 Bad Request`</li>
</ul>
</li>
<li><b>Constraint Violations</b>:<ul>
<li><b>Method</b>: <code>handleConstraintViolation</code></li>
<li><b>Handles</b>: Validation constraints not met (<code>ConstraintViolationException.class</code>)</li>
<li><b>Response</b>: ```json { "message": "Constraint violation: {exception message}" } ``<code></code></li>
<li><code>**HTTP Status**:</code>400 Bad Request`</li>
</ul>
</li>
<li><b>Resource Not Found</b>:<ul>
<li><b>Method</b>: <code>handleNotFoundException</code></li>
<li><b>Handles</b>: Cases where a requested resource is not found (<code>CustomNotFoundException.class</code>)</li>
<li><b>Response</b>: ```json { "message": "{exception message}" } ``<code></code></li>
<li><code>**HTTP Status**:</code>404 Not Found`</li>
</ul>
</li>
<li><b>Data Integrity Violations</b>:<ul>
<li><b>Method</b>: <code>handleDataIntegrityViolation</code></li>
<li><b>Handles</b>: Data integrity issues, such as unique constraint violations (<code>DataIntegrityViolationException.class</code>)</li>
<li><b>Response</b>: ```json { "message": "Data integrity violation: {specific cause}" } ``<code></code></li>
<li><code>**HTTP Status**:</code>409 Conflict`</li>
</ul>
</li>
<li><b>Cache Retrieval Errors</b>:<ul>
<li><b>Method</b>: <code>handleCacheRetrievalException</code></li>
<li><b>Handles</b>: Errors related to cache retrieval operations (<code>CacheRetrievalException.class</code>)</li>
<li><b>Response</b>: ```json { "message": "Error retrieving data from cache: {exception message}" } ``<code></code></li>
<li><code>**HTTP Status**:</code>500 Internal Server Error`</li>
</ul>
</li>
<li><b>Database Fetch Errors</b>:<ul>
<li><b>Method</b>: <code>handleDatabaseFetchException</code></li>
<li><b>Handles</b>: Errors when fetching data from the database (<code>DatabaseFetchException.class</code>)</li>
<li><b>Response</b>: ```json { "message": "Error fetching data from the database: {exception message}" } ``<code></code></li>
<li><code>**HTTP Status**:</code>500 Internal Server Error`</li>
</ul>
</li>
<li><b>Service Layer Errors</b>:<ul>
<li><b>Method</b>: <code>handleCustomServiceException</code></li>
<li><b>Handles</b>: Errors that occur within the service layer (<code>CustomServiceException.class</code>)</li>
<li><b>Response</b>: ```json { "message": "An error occurred: {exception message}" } ``<code></code></li>
<li><code>**HTTP Status**:</code>500 Internal Server Error`</li>
</ul>
</li>
</ol>
<h1><a class="anchor" id="autotoc_md63"></a>
Cache Strategy</h1>
<p>The Mini Hacker News project implements a sophisticated caching strategy to optimize performance and reduce database load. The caching mechanism ensures that the most relevant posts are stored in memory, allowing for quick retrieval and reducing the need for repeated database queries.</p>
<h3><a class="anchor" id="autotoc_md64"></a>
Key Features of the Cache Strategy</h3>
<ol type="1">
<li><b>Priority-Based Caching</b>:<ul>
<li>The cache is designed to store posts based on their score. Higher-scoring posts are given priority, ensuring that the most popular content is readily accessible.</li>
<li>The cache is implemented using a combination of <code>PriorityBlockingQueue</code> and <code>ConcurrentHashMap</code>, where the queue maintains posts in a sorted order based on their score, and the map allows for quick lookup by post ID.</li>
</ul>
</li>
<li><b>Size Limitation</b>:<ul>
<li>The cache has a configurable maximum size (<code>cache.size</code>), which determines how many posts can be stored at any given time. Once the cache reaches its maximum size, the post with the lowest score is evicted to make room for new, higher-scoring posts.</li>
</ul>
</li>
<li><b>Dynamic Updates</b>:<ul>
<li>The cache is updated dynamically in response to CRUD operations:<ul>
<li><b>SavePost</b>: When a new post is saved, it is evaluated to determine if it should be added to the cache. If its score is higher than the lowest-scoring post in the cache (or if there is room in the cache), it is added.</li>
<li><b>Upvote/Downvote</b>: When a post is upvoted or downvoted, its position in the cache is reevaluated. If its score changes significantly, it may be moved within the cache or evicted if it no longer qualifies as a top post.</li>
<li><b>UpdatePost</b>: If a post is updated, its score and relevance are reassessed. The cache is then updated accordingly to ensure that only the most relevant posts are retained.</li>
<li><b>DeletePost</b>: When a post is deleted, it is removed from the cache, and the next highest-scoring post (if available) is fetched from the database and added to the cache.</li>
</ul>
</li>
</ul>
</li>
<li><b>Eviction Policy</b>:<ul>
<li>The cache eviction policy is based on the post's score. When the cache is full, the post with the lowest score is automatically evicted to make space for new entries.</li>
<li>This strategy ensures that the cache always contains the most relevant content, making it efficient for serving requests that require the top posts.</li>
</ul>
</li>
<li><b>Concurrency Control</b>:<ul>
<li>The caching mechanism is designed to be thread-safe, allowing concurrent read and write operations without data inconsistency or race conditions.</li>
<li>Synchronization is used when updating the cache to ensure that operations such as eviction and insertion are performed atomically.</li>
</ul>
</li>
<li><b>Cache Monitoring and Logging</b>:<ul>
<li>The application includes logging capabilities to monitor cache operations, such as insertions, evictions, and retrievals. This is useful for debugging and understanding the cache's behavior under different load conditions.</li>
</ul>
</li>
</ol>
<h3><a class="anchor" id="autotoc_md65"></a>
Example Configuration</h3>
<p>The following configuration properties can be adjusted in the <code>application.properties</code> file to customize the cache behavior:</p>
<p>```properties </p>
<h1><a class="anchor" id="autotoc_md66"></a>
Set Cache SIZE and Limit SIZE</h1>
<p>cache.size=100 posts.page.limit=150</p>
<h1><a class="anchor" id="autotoc_md67"></a>
Set your field update interval here</h1>
<p>db.update.interval=600000 </p>
<h1><a class="anchor" id="autotoc_md68"></a>
3600000 # 1 hour in milliseconds</h1>
<h1><a class="anchor" id="autotoc_md69"></a>
Set your logging path here:</h1>
<p>logging.file.name=logs/myapp.log</p>
<h2><a class="anchor" id="autotoc_md70"></a>
Support and Contribution</h2>
<p>Contributions to the Mini Hacker News project are welcome! Please feel free to fork the repository, make your changes, and submit a pull request.</p>
<h2><a class="anchor" id="autotoc_md71"></a>
License</h2>
<p>This project is licensed under the MIT License </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
